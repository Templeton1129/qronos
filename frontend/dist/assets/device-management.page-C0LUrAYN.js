import{T as G}from"./index-BuJupokE.js";import{s as H,a as K}from"./index-oUEh44lC.js";import{s as P}from"./index-Pqloj2nT.js";import{s as U}from"./index-C4uR4OqR.js";import{s as q,a as A}from"./index-D8JLJnMc.js";import{s as F}from"./index-vgbU9hMy.js";import{_ as O,s as Q,$ as J}from"./index-B_GZmL3k.js";import{g as R,q as W,h as r,I as X,b as $,j as e,i as t,w as a,o as f,D as _,n as b,t as i,d as I,e as w,A as Z,y as ee,Q as se}from"./index-DbB14CKm.js";import{d as le}from"./index-CkHj5rSV.js";import"./index-DCjXDbvw.js";const te={class:"h-full w-full p-2 sm:p-6 flex flex-col items-center"},ae={class:"w-full max-w-6xl space-y-2 sm:space-y-6"},oe={class:"w-full space-y-2 sm:space-y-4"},ie={class:"flex justify-between items-end"},ne={class:"flex items-center gap-2"},re={class:"flex items-center gap-2"},de={class:"flex flex-col"},ce={class:"flex items-center gap-1"},ue={class:"flex flex-col gap-4"},me={role:"list",class:"list-disc space-y-2 text-sm bg-gray-100 dark:bg-neutral-800 rounded-xl p-3 pl-8"},pe={class:"flex flex-col gap-2"},ve={key:0,class:"text-red-500"},fe={class:"flex justify-end gap-3"},Ie=R({__name:"device-management.page",setup(_e){const L=W(),k=r([]),m=r(!1),p=r(!1),n=r(),g=r(!1),d=r(""),c=r("");X(()=>{y()});const T=o=>{switch(o.toLowerCase()){case"pc":return"pi pi-desktop";case"mobile":return"pi pi-mobile";case"tablet":return"pi pi-tablet";default:return"pi pi-device"}},y=async()=>{m.value=!0;const o=await O();m.value=!1,o.result===!0&&(k.value=o.data)},V=o=>{n.value=o,p.value=!0},C=()=>{p.value=!1,n.value=null,d.value="",c.value=""},D=async()=>{if(!n.value)return;if(!d.value){c.value="请输入谷歌验证码";return}g.value=!0,c.value="";const o=await J(n.value.id,d.value);g.value=!1,o.result===!0&&(L.add({severity:"success",summary:"操作成功",detail:"设备已被强制下线",life:3e3}),C(),y())};return(o,s)=>{const v=Q,B=F,u=A,j=K,M=q,N=U,Y=P,z=H,S=G;return f(),$("div",te,[e("div",ae,[e("div",oe,[e("div",ie,[s[2]||(s[2]=e("h2",{class:"text-2xl font-semibold text-gray-800 dark:text-gray-200"}," 设备管理 ",-1)),t(v,{icon:"pi pi-refresh",label:"刷新",size:"small",onClick:y,loading:m.value,class:"mr-20"},null,8,["loading"])]),s[4]||(s[4]=e("div",{class:"hidden sm:block text-sm text-gray-500 dark:text-gray-300"}," 本系统最多允许5台设备登录使用，若新增登录设备数量超过限制，系统会自动将此前登录的设备依次剔除，保证当前仅5台设备有效 ",-1)),t(B,{severity:"secondary",closable:!1,size:"small",class:"block sm:hidden mt-2"},{default:a(()=>s[3]||(s[3]=[_(" 本系统最多允许5台设备登录使用，若新增登录设备数量超过限制，系统会自动将此前登录的设备依次剔除，保证当前仅5台设备有效 ")])),_:1,__:[3]})]),t(N,null,{content:a(()=>[t(M,{value:k.value,loading:m.value,rows:5,responsiveLayout:"scroll",class:"sm:px-4 text-sm"},{default:a(()=>[t(u,{field:"device_type",header:"设备类型",class:"min-w-20"},{body:a(({data:l})=>[e("div",ne,[e("i",{class:b([T(l.device_type),"text-lg"])},null,2),e("span",null,i(l.device_type),1)])]),_:1}),t(u,{field:"browser_info",header:"浏览器",class:"min-w-55"},{body:a(({data:l})=>[e("div",re,[e("span",{class:b(l.is_current?"font-bold":"")},i(l.browser_info),3),l.is_current?(f(),I(j,{key:0,class:"text-xs font-semibold",value:"当前设备"})):w("",!0)])]),_:1}),t(u,{field:"ip_address",header:"IP地址",class:"min-w-30"},{body:a(({data:l})=>[e("div",de,[e("span",null,i(l.ip_address),1)])]),_:1}),t(u,{field:"last_active_time",header:"最后活跃时间",class:"min-w-45"},{body:a(({data:l})=>[e("div",ce,[e("span",null,i(Z(le)(l.last_active_time).format("YYYY-MM-DD HH:mm:ss")),1)])]),_:1}),t(u,{header:"操作",exportable:!1,style:{"min-width":"8rem"}},{body:a(({data:l})=>[l.is_current?w("",!0):ee((f(),I(v,{key:0,icon:"pi pi-power-off",severity:"danger",text:"",onClick:x=>V(l)},null,8,["onClick"])),[[S,"强制下线设备"]])]),_:1})]),_:1},8,["value","loading"])]),_:1})]),t(z,{visible:p.value,"onUpdate:visible":s[1]||(s[1]=l=>p.value=l),header:"确认强制下线",modal:!0,closable:!1,class:"max-w-[90vw] min-w-[80vw] sm:min-w-[35vw]"},{footer:a(()=>[e("div",fe,[t(v,{label:"取消",severity:"secondary",outlined:"",onClick:C,class:"rounded-lg"}),t(v,{label:"确认",onClick:D,loading:g.value,disabled:d.value.length<6,class:"rounded-lg"},null,8,["loading","disabled"])])]),default:a(()=>{var l,x,h;return[e("div",ue,[s[9]||(s[9]=e("p",{class:"text-gray-700 dark:text-gray-300"}," 确定要将以下设备强制下线吗？ ",-1)),e("ul",me,[e("li",null,[s[5]||(s[5]=e("span",{class:"font-semibold"},"设备：",-1)),_(i((l=n.value)==null?void 0:l.device_type),1)]),e("li",null,[s[6]||(s[6]=e("span",{class:"font-semibold"},"浏览器：",-1)),_(i((x=n.value)==null?void 0:x.browser_info),1)]),e("li",null,[s[7]||(s[7]=e("span",{class:"font-semibold"},"IP地址：",-1)),_(i((h=n.value)==null?void 0:h.ip_address),1)])]),e("div",pe,[s[8]||(s[8]=e("label",{class:"text-sm font-medium text-gray-600 dark:text-gray-300"},"谷歌验证码",-1)),t(Y,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=E=>d.value=E),placeholder:"请输入谷歌验证码校验身份",class:b(["w-full rounded-lg border-gray-300 dark:border-neutral-600 dark:bg-neutral-800",{"p-invalid":c.value}]),maxlength:6,onKeyup:se(D,["enter"])},null,8,["modelValue","class"]),c.value?(f(),$("small",ve,i(c.value),1)):w("",!0)])])]}),_:1},8,["visible"])])}}});export{Ie as default};
